<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Portal - Events & Profiles</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f4f6fa;
      color: #333;
    }
    header {
      background: #3f51b5;
      color: white;
      padding: 10px 20px;
    }
    nav a {
      margin: 0 10px;
      color: white;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }
    section {
      display: none;
      padding: 20px;
    }
    section.active {
      display: block;
    }

    /* Cards */
    .card {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .card h3 {
      margin: 0;
      color: #3f51b5;
    }

    /* Table */
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #3f51b5;
      color: white;
    }

    /* Pagination */
    .pagination {
      margin-top: 10px;
      text-align: center;
    }
    .pagination button {
      margin: 0 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      background: #3f51b5;
      color: white;
      cursor: pointer;
    }

    /* Country-State Dropdown */
    .dropdown-box {
      margin: 20px 0;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    /* CAPTCHA */
    #captchaBox {
      margin: 20px 0;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    canvas {
      border: 1px solid #ddd;
      display: block;
      margin-bottom: 10px;
    }
    input {
      padding: 8px;
      margin: 5px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button.verify {
      background: #4caf50;
      color: white;
    }
  </style>
</head>
<body>
  <header>
    <span>Student Portal</span>
    <nav>
      <a data-page="events">Events</a>
      <a data-page="profiles">Profiles</a>
      <a data-page="dropdown">Dropdown</a>
      <a data-page="captcha">Captcha</a>
    </nav>
  </header>

  <!-- Events -->
  <section id="events" class="active">
    <h2>Events List</h2>
    <div id="eventsContainer"></div>
    <div class="pagination" id="pagination"></div>
  </section>

  <!-- Student Profiles -->
  <section id="profiles">
    <h2>Student Profiles</h2>
    <table>
      <thead>
        <tr><th>Name</th><th>Age</th><th>Course</th></tr>
      </thead>
      <tbody id="profileBody"></tbody>
    </table>
  </section>

  <!-- Dependent Dropdown -->
  <section id="dropdown">
    <h2>Country & State Selector</h2>
    <div class="dropdown-box">
      <label>Country:</label>
      <select id="countrySelect"></select>
      <br>
      <label>State:</label>
      <select id="stateSelect"></select>
    </div>
  </section>

  <!-- CAPTCHA -->
  <section id="captcha">
    <h2>Custom CAPTCHA</h2>
    <div id="captchaBox">
      <canvas id="captchaCanvas" width="200" height="50"></canvas>
      <input type="text" id="captchaInput" placeholder="Enter CAPTCHA">
      <button class="verify" id="verifyBtn">Verify</button>
      <p id="captchaMsg"></p>
    </div>
  </section>

  <script>
    /* ---------------- JSON DATA ---------------- */
    const eventsJSON = `[
      {"title":"Orientation","date":"2025-09-25","desc":"Welcome program for new students"},
      {"title":"Tech Fest","date":"2025-10-10","desc":"Annual technology event"},
      {"title":"Workshop","date":"2025-10-15","desc":"Web development hands-on session"},
      {"title":"Sports Day","date":"2025-11-01","desc":"Annual sports meet"},
      {"title":"Cultural Night","date":"2025-11-20","desc":"Music, dance and art performances"},
      {"title":"Hackathon","date":"2025-12-05","desc":"Coding competition for all students"}
    ]`;

    const profilesJSON = `[
      {"name":"Aryan","age":20,"course":"B.Tech CSE"},
      {"name":"Neha","age":21,"course":"B.Sc Physics"},
      {"name":"Ravi","age":19,"course":"B.Com"},
      {"name":"Anjali","age":22,"course":"MBA"},
      {"name":"Karan","age":20,"course":"B.Tech IT"}
    ]`;

    const countries = {
      "India": ["Maharashtra","Gujarat","Punjab","Kerala"],
      "USA": ["California","Texas","New York","Florida"],
      "Canada": ["Ontario","Quebec","Alberta"]
    };

    /* ---------------- PARSING JSON ---------------- */
    const eventsData = JSON.parse(eventsJSON);
    const profilesData = JSON.parse(profilesJSON);

    /* ---------------- EVENTS with PAGINATION ---------------- */
    const eventsContainer = document.getElementById("eventsContainer");
    const pagination = document.getElementById("pagination");
    let currentPage = 1;
    const eventsPerPage = 2;

    function renderEvents(page=1) {
      eventsContainer.innerHTML = "";
      const start = (page-1) * eventsPerPage;
      const end = start + eventsPerPage;
      const paginatedEvents = eventsData.slice(start, end);
      
      paginatedEvents.forEach(ev => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<h3>${ev.title}</h3><p>${ev.date}</p><p>${ev.desc}</p>`;
        eventsContainer.appendChild(div);
      });

      renderPagination();
    }

    function renderPagination() {
      pagination.innerHTML = "";
      const totalPages = Math.ceil(eventsData.length / eventsPerPage);
      for (let i=1; i<=totalPages; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.addEventListener("click", () => {
          currentPage = i;
          renderEvents(currentPage);
        });
        pagination.appendChild(btn);
      }
    }

    renderEvents();

    /* ---------------- STUDENT PROFILES ---------------- */
    const profileBody = document.getElementById("profileBody");
    profilesData.forEach(st => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${st.name}</td><td>${st.age}</td><td>${st.course}</td>`;
      profileBody.appendChild(tr);
    });

    /* ---------------- COUNTRY-STATE DROPDOWN ---------------- */
    const countrySelect = document.getElementById("countrySelect");
    const stateSelect = document.getElementById("stateSelect");

    function populateCountries() {
      Object.keys(countries).forEach(c => {
        const opt = document.createElement("option");
        opt.value = c;
        opt.textContent = c;
        countrySelect.appendChild(opt);
      });
    }

    function populateStates(country) {
      stateSelect.innerHTML = "";
      countries[country].forEach(st => {
        const opt = document.createElement("option");
        opt.value = st;
        opt.textContent = st;
        stateSelect.appendChild(opt);
      });
    }

    populateCountries();
    countrySelect.addEventListener("change", () => {
      populateStates(countrySelect.value);
    });
    populateStates("India"); // default

    /* ---------------- CAPTCHA ---------------- */
    const captchaCanvas = document.getElementById("captchaCanvas");
    const ctx = captchaCanvas.getContext("2d");
    let captchaText = "";

    function generateCaptcha() {
      captchaText = Math.random().toString(36).substring(2,7); // random 5 letters
      ctx.clearRect(0,0,200,50);
      ctx.font = "30px Arial";
      ctx.fillStyle = "#3f51b5";
      ctx.fillText(captchaText, 50, 35);
    }

    document.getElementById("verifyBtn").addEventListener("click", () => {
      const input = document.getElementById("captchaInput").value;
      const msg = document.getElementById("captchaMsg");
      if (input === captchaText) {
        msg.textContent = "✅ Correct!";
        msg.style.color = "green";
      } else {
        msg.textContent = "❌ Incorrect. Try again.";
        msg.style.color = "red";
        generateCaptcha();
      }
    });

    generateCaptcha();

    /* ---------------- NAVIGATION ---------------- */
    document.querySelectorAll("nav a").forEach(link => {
      link.addEventListener("click", () => {
        document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
        document.getElementById(link.dataset.page).classList.add("active");
      });
    });
  </script>
</body>
</html>
